
# V8 引擎 v7.7 版本

>v7.7版本将会随着几周后的 Chrome 77 稳定版发布

## 1. 性能（大小和速度）

为了优化 JavaScript，V8团队收集了许多交由操作数来使用的操作符（例如 + 和 o.foo）。这些所收集的反馈通过指定类型来优化这些操作。这些信息被存储在“反馈变量里”，这些信息对于实现更快的执行效率十分重要。我们还为分配这些反馈向量所需的内存使用花费不少精力。

为了减少V8的内存使用，我们现在只在函数执行了一定量的字节码后才惰性地分配反馈向量。 这避免了为不能从所收集的反馈中受益的短期函数分配反馈向量。 我们的实验数据表明，惰性分配反馈向量可以节省大约2-8％的V8堆内存大小。

![V8](https://v8.dev/_img/v8-release-77/lazy-feedback-allocation.svg)

我们的实验数据表明，这可以减少桌面端V8堆内存占用1-2%，并为Chrome用户在移动平台上降低5-6％。 桌面端没有性能回归，在移动平台上，我们实际上看到在低端手机上的性能提升十分有限。 请留意我们最近为节省内存所做的更详细的博客文章。

## 2. 可扩展的WebAssembly后台编译

在最后的里程碑中，我们致力于WebAssembly的后台编译的可伸缩性。 您的计算机拥有的内核越多，您从这项工作中获益的就越多。 下图是在24核Xeon机器上创建的，编译了Epic ZenGarden演示。 根据所使用的线程数，与V8 v7.4相比，编译所需的时间不到一半。

![V8](https://v8.dev/_img/v8-release-77/liftoff-compilation-speedup.svg)

## 3. 堆栈追踪改进

V8抛出的几乎所有错误都会在创建时捕获堆栈跟踪。 可以通过非标准error.stack属性从JavaScript访问此堆栈跟踪。 第一次通过error.stack检索堆栈跟踪时，V8将基础结构化堆栈跟踪序列化为字符串。 保留此序列化堆栈跟踪以加速将来的error.stack访问。

## 4. JavaScript 语言新特性

对于区域的数字格式，在此版本中获得了新功能！ 它现在支持紧凑标记，科学记数法，工程符号，符号显示和测量单位。

```js
const formatter = new Intl.NumberFormat('en', {
  style: 'unit',
  unit: 'meter-per-second',
});
formatter.format(299792458);
// → '299,792,458 m/s'
```

## 参考

[V8团队博客](https://v8.dev/blog/v8-release-77)